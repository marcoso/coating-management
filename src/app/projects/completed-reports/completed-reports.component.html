<section class="content">
	<div class="container-fluid">		
		<div class="card">
			<div class="header">
				<h2>Completed <b>Reports</b></h2>
                <div class="new-button">                    
                    <button class="btn btn-info waves-effect" (click)="addReport()">
                        <i class="material-icons">add</i>
                        <span>ADD REPORT</span>
                    </button>                                            
                </div>
			</div>
			<div class="body">
				<div class="table-responsive">                    
                    <div class="row">                        
                        <div class="col-sm-12 col-md-12">
                            <div id="DataTables_Table_0_filter" class="dataTables_filter float-end">
                                <label>Search:<input type="search" #filter class="browser-default search-field float-end" placeholder="" aria-label="Search box"></label>                                    
                            </div>
                        </div>                        
                    </div>            
                    <div class="row">                        
                        <div class="col-sm-12 col-md-12">
                            <table mat-table [dataSource]="dataSource" class="table table-bordered table-hover dataTable" matSort>
                            
                                <!-- Project Name Column -->
                                <ng-container matColumnDef="projectName">
                                    <th mat-header-cell *matHeaderCellDef mat-sort-header>Project</th>
                                    <td mat-cell *matCellDef="let element"> {{element.projectName}}  </td>
                                </ng-container>
                            
                                <!-- Report Filename Column -->
                                <ng-container matColumnDef="filename">
                                    <th mat-header-cell *matHeaderCellDef mat-sort-header>Filename</th>
                                    <td mat-cell *matCellDef="let element"> {{element.filename}}  </td>
                                </ng-container>
            
                                <!-- createdAt Column -->
                                <ng-container matColumnDef="createdAt">
                                    <th mat-header-cell *matHeaderCellDef mat-sort-header>Created Date</th>
                                    <td mat-cell *matCellDef="let element"> {{ element.createdAt === null ? '-' : element.createdAt | date:'MM/dd/yyyy'}}  </td>
                                </ng-container>
            
                                <!-- Created by User Column -->
                                <ng-container matColumnDef="reportCreator">
                                    <th mat-header-cell *matHeaderCellDef mat-sort-header>Generated By</th>
                                    <td mat-cell *matCellDef="let element"> {{element.createdBy ? element.createdByLastName + ', ' + element.createdByName : '-' }}   </td>
                                </ng-container>

                                <!-- Source Column -->
                                <ng-container matColumnDef="source">
                                    <th mat-header-cell *matHeaderCellDef mat-sort-header>Source</th>
                                    <td mat-cell *matCellDef="let element"> {{element.source === null ? '-' : element.source | projectReportType}}</td>
                                </ng-container>
            
                                <!-- Detail Column -->
                                <ng-container matColumnDef="detail">
                                    <th mat-header-cell *matHeaderCellDef mat-sort-header>Download</th>
                                    <td mat-cell *matCellDef="let element">							
                                        <a class="btn btn-tbl-edit btn-outline-success" (click)="downloadReport(element.projectReportId, element.filename)">
                                            <i class="material-icons" >file_download</i>
                                        </a>
                                    </td>
                                </ng-container>
                            
                                <tr mat-header-row *matHeaderRowDef="displayedColumns"> </tr>
                                <tr mat-row *matRowDef="let row; columns: displayedColumns;"> </tr>
                            </table>
                            <!-- Loading spinner -->
                            <div *ngIf="projectService.isProjectReportsDataLoading" class="tbl-spinner">
                                <mat-progress-spinner color="primary" [diameter]="40" mode="indeterminate">
                                </mat-progress-spinner>
                            </div>
                            <div *ngIf="!projectService.isProjectReportsDataLoading" [style.display]="dataSource.renderedData.length == 0 ? '' : 'none'"  class="text-center">
                                No results
                            </div>
                            <mat-paginator #paginator [length]="dataSource.filteredData.length" [pageIndex]="0" [pageSize]="10" [pageSizeOptions]="[5, 10, 25, 100]">
                            </mat-paginator>
                        </div>
                    </div>			
				</div>				
			</div>
		</div>
	</div>
</section>